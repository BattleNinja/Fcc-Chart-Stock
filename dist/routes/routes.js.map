{"version":3,"sources":["../../server/routes/routes.js"],"names":["express","require","router","Router","Stock","financeController","api","post","req","res","name","body","addStock","err","stock","send","deletStock","get","initializer","length","data","find","stocks","forEach","item","getHistoricalData","then","next","msg","catch","console","log","subscribe","push","json","module","exports"],"mappings":";;AAIA;;AAJA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAMC,SAASF,QAAQG,MAAR,EAAf;AACA,IAAMC,QAAQH,QAAQ,gBAAR,CAAd;AACA,IAAMI,oBAAoBJ,QAAQ,mCAAR,CAA1B;;AAEA,IAAMK,MAAML,QAAQ,qBAAR,CAAZ;;AAGAC,OAAOK,IAAP,CAAY,WAAZ,EAAyB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACnC,QAAMC,OAAOF,IAAIG,IAAJ,CAASD,IAAtB;AACAN,UAAMQ,QAAN,CAAeF,IAAf,EAAqB,UAACG,GAAD,EAAMC,KAAN,EAAgB;AACjC,YAAID,GAAJ,EAAS,MAAMA,GAAN;AACTJ,YAAIM,IAAJ,CAASD,KAAT;AACH,KAHD;AAIH,CAND;;AAQAZ,OAAOK,IAAP,CAAY,aAAZ,EAA2B,UAACC,GAAD,EAAMC,GAAN,EAAc;AACrC,QAAMC,OAAOF,IAAIG,IAAJ,CAASD,IAAtB;AACAN,UAAMY,UAAN,CAAiBN,IAAjB,EAAuB,UAACG,GAAD,EAAMC,KAAN,EAAgB;AACnC,YAAID,GAAJ,EAAS,MAAMA,GAAN;AACTJ,YAAIM,IAAJ,CAASD,KAAT;AACH,KAHD;AAIH,CAND;;AAQAZ,OAAOe,GAAP,CAAW,aAAX,EAA0B,UAACT,GAAD,EAAMC,GAAN,EAAc;AACpC,QAAMS,cAAc,sBAApB;AACA,QAAIC,SAAS,CAAb;AACA,QAAIC,OAAO,EAAX;AACAhB,UAAMiB,IAAN,CAAW,EAAX,EAAe,UAACR,GAAD,EAAMS,MAAN,EAAiB;AAC5B,YAAIT,GAAJ,EAAS,MAAMA,GAAN;AACTM,iBAASG,OAAOH,MAAhB;AACAG,eAAOC,OAAP,CAAe,UAACC,IAAD,EAAU;AACrBlB,gBACKmB,iBADL,CACuBD,KAAKd,IAD5B,EACkC,IADlC,EACwC,IADxC,EAEKgB,IAFL,CAEU;AAAA,uBAAOR,YAAYS,IAAZ,CAAiB,EAACb,OAAOU,KAAKd,IAAb,EAAmBkB,KAAKA,GAAxB,EAAjB,CAAP;AAAA,aAFV,EAGKC,KAHL,CAGW;AAAA,uBAAOC,QAAQC,GAAR,CAAYlB,GAAZ,CAAP;AAAA,aAHX;AAIH,SALD;AAMH,KATD;AAUAK,gBAAYc,SAAZ,CAAsB,iBAAS;AAC3BZ,aAAKa,IAAL,CAAUnB,KAAV;AACA,YAAIM,KAAKD,MAAL,KAAgBA,MAApB,EAA4B;AACxBV,gBAAIyB,IAAJ,CAASd,IAAT;AACH;AACJ,KALD;AAMH,CApBD;;AAsBAe,OAAOC,OAAP,GAAiBlC,MAAjB","file":"routes.js","sourcesContent":["const express = require('express');\nconst router = express.Router();\nconst Stock = require('../model/stock');\nconst financeController = require('./../controller/financeController');\nimport {Subject} from 'rxjs/Subject';\nconst api = require('./../config/finance');\n\n\nrouter.post('/addstock', (req, res) => {\n    const name = req.body.name;\n    Stock.addStock(name, (err, stock) => {\n        if (err) throw err;\n        res.send(stock);\n    });\n});\n\nrouter.post('/deletstock', (req, res) => {\n    const name = req.body.name;\n    Stock.deletStock(name, (err, stock) => {\n        if (err) throw err;\n        res.send(stock);\n    });\n});\n\nrouter.get('/initialize', (req, res) => {\n    const initializer = new Subject();\n    let length = 0;\n    let data = [];\n    Stock.find({}, (err, stocks) => {\n        if (err) throw err;\n        length = stocks.length;\n        stocks.forEach((item) => {\n            api\n                .getHistoricalData(item.name, '1d', '1y')\n                .then(msg => initializer.next({stock: item.name, msg: msg}))\n                .catch(err => console.log(err));\n        });\n    });\n    initializer.subscribe(stock => {\n        data.push(stock);\n        if (data.length === length) {\n            res.json(data);\n        }\n    });\n});\n\nmodule.exports = router;"]}